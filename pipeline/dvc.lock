schema: '2.0'
stages:
  setup:
    cmd:
    - UV_LINK_MODE=copy uv venv .venv --python 3.9
    - .venv/bin/python -m ensurepip --upgrade
    - .venv/bin/python -m pip install -q --no-cache-dir uv
    - .venv/bin/uv pip install -q --no-cache-dir -e .
    - .venv/bin/uv pip install -q --no-cache-dir -r requirements/base.txt
    - rsync -a .venv/ .venv-models/
    - .venv-models/bin/uv pip install --no-cache-dir -r requirements/models.txt
    - .venv/bin/uv pip freeze > requirements/base-frozen.txt
    - .venv/bin/uv pip freeze > requirements/models-frozen.txt
    deps:
    - path: requirements/base.txt
      hash: md5
      md5: 4bd98f027655a386974abd690786183e
      size: 110
    - path: requirements/models.txt
      hash: md5
      md5: 1990e8fd4cc60ee9ec446af8d9970aa4
      size: 35
    outs:
    - path: .venv
      hash: md5
      md5: d751713988987e9331980363e24189ce.dir
      size: 0
      nfiles: 0
    - path: .venv-models
      hash: md5
      md5: 5e9950bda60646a6ed738f5ab3b9e5f0.dir
      size: 347798826
      nfiles: 14537
    - path: requirements/base-frozen.txt
      hash: md5
      md5: 34e05ea34608c568b527ed458cf0cc4f
      size: 2803
    - path: requirements/models-frozen.txt
      hash: md5
      md5: 34e05ea34608c568b527ed458cf0cc4f
      size: 2803
